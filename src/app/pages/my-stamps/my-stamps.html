<div class="min-h-screen max-w-2xl mx-auto p-4 space-y-6">
    <div class="max-w-2xl mx-auto">
        @if (loading) {
            <nz-skeleton [nzActive]="true" [nzParagraph]="{ rows: 6 }"></nz-skeleton>
        }
        @else if (data) {
            <div class="mb-6">
                <div class="relative rounded-lg overflow-hidden h-40 bg-bg-light-beige">
                    @if (data.banner) {
                        <img src="{{ data.banner }}" alt="{{ data.name }}" class="w-full h-full object-cover" />
                    }
                </div>

                <div class="flex justify-between items-center">
                    <div class="company-banner-logo flex items-center gap-4 z-10">
                        @if (data.logo) {
                            <img src="{{ data.logo }}" alt="{{ data.name }}" class="w-16 h-16 rounded-lg border-2 border-white object-cover bg-white" />
                        }
                        @else {
                            <div class="w-16 h-16 rounded-lg border-2 border-white bg-white flex items-center justify-center">
                                <i class="ph ph-store text-xl text-gray-500"></i>
                            </div>
                        }

                        <div>
                            <div class="text-2xl font-semibold">{{ data.name }}</div>
                            <div class="text-sm text-color-secondary">Você possui {{ data.quantity }} selos</div>
                        </div>
                    </div>
                    <div class="font-semibold text-sm mr-4 cursor-pointer flex items-center gap-2" (click)="modalVisible = true; modalCompany = data" role="button" tabindex="0">
                        <i class="ph ph-plus-circle"></i>
                        Informações
                    </div>
                </div>
            </div>

            <div class="space-y-6">
                @for (card of data.cards; track card.id) {
                    <div class="mb-6">
                        <app-card [card]="card"></app-card>
                    </div>
                }
            </div>
        }
        @else {
            <div class="text-center text-gray-500">Nenhum dado encontrado para esta empresa.</div>
        }
    </div>
</div>


<nz-modal [(nzVisible)]="modalVisible" nzTitle="Informações da empresa" [nzWidth]="650" [nzFooter]="modalFooter">
    <ng-container *nzModalContent>
        <div class="p-4" style="max-width:420px;">
        <h2 class="text-lg font-semibold mb-2">Endereço</h2>
        <div class="mb-3">{{ modalCompany?.street || '—' }} {{ modalCompany?.number || '' }} {{ modalCompany?.complement ? ('- ' + modalCompany.complement) : '' }}<br />{{ modalCompany?.neighborhood || '—' }}<br />{{ modalCompany?.city ? (modalCompany.city + ' - ' + (modalCompany.state || '')) : (modalCompany.state || '—') }}</div>
        <div class="mb-4">CEP: {{ (modalCompany?.zip_code | mask:'00000-000') || '—' }}</div>

        <h2 class="text-lg font-semibold mb-2">Contato</h2>
        <div class="flex items-center gap-2 mb-2">
            <i class="ph ph-phone text-lg"></i>
            @if (modalCompany?.phone) {
                <span><a [href]="'tel:' + modalCompany.phone">{{ formatPhone(modalCompany?.phone) }}</a></span>
            }
            @else {
                <span>—</span>
            }
        </div>
        <div class="flex items-center gap-2 mb-2">
            <i class="ph ph-envelope text-lg"></i>
            @if (modalCompany?.email) {
                <span><a [href]="'mailto:' + modalCompany.email">{{ modalCompany?.email }}</a></span>
            }
            @else {
                <span>—</span>
            }
        </div>
        <div class="flex items-center gap-2 mb-2">
            <i class="ph ph-globe text-lg"></i>
            @if (modalCompany?.website) {
                <span><a [href]="modalCompany.website" target="_blank" rel="noopener">{{ modalCompany.website }}</a></span>
            }
            @else {
                <span>—</span>
            }
        </div>
    </div>
    </ng-container>

    <ng-template #modalFooter>
        <button nz-button nzType="primary" (click)="handleOk()">Fechar</button>
    </ng-template>
</nz-modal>
