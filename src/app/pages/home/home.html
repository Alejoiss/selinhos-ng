<div class="min-h-screen bg-gray-50">
	<div class="max-w-5xl mx-auto p-6">
		<!-- Top bar -->
		<div class="flex items-center justify-between mb-6">
			<div class="flex items-center space-x-4">
				<a [routerLink]="['/selecionar-cidade']" class="flex items-center space-x-2 text-gray-700 hover:text-gray-900">
					<i class="ph ph-map-pin text-xl"></i>
					<div>
						<div class="text-sm font-semibold">Cidade</div>
						@if ((consumer$ | async)?.selected_city) {
							<div class="text-sm text-gray-500">{{ (consumer$ | async)?.selected_city?.name }} - {{ (consumer$ | async)?.selected_city?.state?.uf }}</div>
						}
						@else {
							<div class="text-sm text-gray-400">Selecionar cidade</div>
						}
					</div>
				</a>
			</div>

			<div class="flex items-center space-x-3">
				<a [routerLink]="['/usuario']" class="p-2 rounded-md hover:bg-gray-100"><i class="ph ph-user text-xl text-gray-700"></i></a>
				<button class="p-2 rounded-md hover:bg-gray-100"><i class="ph ph-qrcode text-xl text-gray-700"></i></button>
			</div>
		</div>

		<!-- Search -->
		<div class="mb-4">
			<div class="relative">
                <button class="add-stamp-button flex items-center gap-3 px-4 py-4 mb-4 w-full text-left">
                    <span class="add-stamp-icon">
                        <i class="ph ph-squares-four text-xl text-white"></i>
                    </span>
                    <span class="font-medium">Adicione selo</span>
                </button>
				<div class="relative">
					<i class="ph ph-magnifying-glass absolute left-4 top-1/2 -translate-y-1/2 text-gray-400"></i>
					<input nz-input [(ngModel)]="searchTerm" (input)="applyFilter()" placeholder="Pesquisar estabelecimentos"
						class="w-full h-12 pl-12 pr-4 border border-gray-300 rounded-md" />
				</div>
			</div>
		</div>

		<!-- Company lists -->
		<div class="grid grid-cols-1 gap-6">
			<div>
				<h3 class="text-lg font-semibold mb-3">Locais com selo</h3>
                @if (stampsCompanies.length === 0) {
                    <div class="text-gray-500">Nenhum local com selo encontrado.</div>
                }
                <ul class="space-y-3">
                    @for (c of stampsCompanies; track c.id) {
                        <li role="button" tabindex="0" (click)="openCompany(c.id)" class="company-card cursor-pointer">
                            <div class="flex items-center">
                                <div class="company-logo w-16 h-16 mr-4 flex items-center justify-center bg-white rounded-md overflow-hidden">
                                    @if (c.logo) {
                                        <img src="{{ c.logo }}" alt="{{ c.name }}" class="w-full h-full object-contain" />
                                    }
                                    @else {
                                        <i class="ph ph-store text-2xl text-gray-500"></i>
                                    }
                                </div>
                                <div>
                                    <div class="italic font-light text-lg">{{ c.name }}</div>
                                </div>
                            </div>
                            <div class="flex flex-col items-end">
                                <div class="badge bg-purple-600 text-white px-3 py-1 rounded-md text-sm font-semibold">{{ c.total_stamps }} selos</div>
                            </div>
                        </li>
                    }
                </ul>
			</div>

			<div>
				<h3 class="text-lg font-semibold mb-3">Outros locais</h3>
                @if (otherCompanies.length === 0) {
                    <div class="text-gray-500">Nenhum outro local encontrado.</div>
                }
                <ul class="space-y-3">
                    @for (c of otherCompanies; track c.id) {
                        <li role="button" tabindex="0" (click)="openCompany(c.id)" class="company-card cursor-pointer">
                            <div class="flex items-center">
                                <div class="company-logo w-16 h-16 mr-4 flex items-center justify-center bg-white rounded-md overflow-hidden">
                                    @if (c.logo) {
                                        <img src="{{ c.logo }}" alt="{{ c.name }}" class="w-full h-full object-contain" />
                                    }
                                    @else {
                                        <i class="ph ph-store text-2xl text-gray-500"></i>
                                    }
                                </div>
                                <div>
                                    <div class="italic font-light text-lg">{{ c.name }}</div>
                                </div>
                            </div>
                            <div class="text-sm text-gray-500">â€”</div>
                        </li>
                    }
                </ul>
			</div>
		</div>
	</div>
</div>

